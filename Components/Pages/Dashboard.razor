@page "/dashboard"
@using System.ComponentModel.DataAnnotations
@using SecureJournalApp.Models
@inject SecureJournalApp.Services.JournalService JournalService
@inject SecureJournalApp.Services.AuthService AuthService

<RedirectToLogin />

<div class="dashboard-container">
    <!-- Header with Stats -->
    <div class="dashboard-header">
        <h1 class="welcome-title">
            <i class="fas fa-tachometer-alt me-2"></i>Journal Dashboard
            <span class="welcome-sub">Welcome back! Here's your journal overview</span>
        </h1>

        <div class="header-stats">
            <div class="header-stat">
                <div class="stat-number streak">@CurrentStreak</div>
                <div class="stat-label">Current Streak</div>
            </div>
            <div class="header-stat">
                <div class="stat-number total">@TotalEntries</div>
                <div class="stat-label">Total Entries</div>
            </div>
            <div class="header-stat">
                <div class="stat-number positive">@PositivePercentage%</div>
                <div class="stat-label">Positive Moods</div>
            </div>
            <div class="header-stat">
                <div class="stat-number longest">@LongestStreak</div>
                <div class="stat-label">Longest Streak</div>
            </div>
        </div>
    </div>

    <!-- Today's Quick Entry -->
    <div class="today-card">
        <div class="today-header">
            <h3>
                <i class="fas fa-calendar-day me-2"></i>Today's Entry
                <span class="date-label">@DateTime.Today.ToString("dddd, MMMM d, yyyy")</span>
            </h3>
            <div class="mood-indicators">
                <span class="mood-label">How are you feeling?</span>
                <div class="mood-buttons">
                    @foreach (var mood in QuickMoods)
                    {
                        <button class="mood-btn @(SelectedMood == mood ? "active" : "")"
                                @onclick="() => SelectMood(mood)">
                            <span class="mood-emoji">@GetMoodEmoji(mood)</span>
                            <span class="mood-name">@mood</span>
                        </button>
                    }
                </div>
            </div>
        </div>

        <div class="today-editor">
            <input type="text"
                   class="entry-title-input"
                   placeholder="Title of today's entry..."
                   @bind="TodayTitle" />

            <textarea class="entry-content-input"
                      placeholder="Write about your day... (Supports Markdown)"
                      @bind="TodayContent"
                      rows="4"></textarea>

            <div class="entry-tags">
                <div class="tags-input">
                    <input type="text"
                           class="tag-input"
                           placeholder="Add tags..."
                           @bind="NewTag"
                           @onkeydown="HandleTagKeyDown" />
                    <button class="add-tag-btn" @onclick="AddTag">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div class="selected-tags">
                    @foreach (var tag in SelectedTags)
                    {
                        <span class="selected-tag">
                            @tag
                            <button class="remove-tag" @onclick="() => RemoveTag(tag)">
                                <i class="fas fa-times"></i>
                            </button>
                        </span>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Analytics Grid -->
    <div class="analytics-grid">
        <!-- Mood Distribution -->
        <div class="analytics-card">
            <div class="card-header">
                <h4><i class="fas fa-chart-pie me-2"></i>Mood Distribution</h4>
                <select class="time-select" @bind="MoodTimeRange">
                    <option value="7">Last 7 days</option>
                    <option value="30">Last 30 days</option>
                    <option value="90">Last 90 days</option>
                    <option value="365">Last year</option>
                </select>
            </div>
            <div class="chart-container">
                <div class="mood-chart">
                    @foreach (var mood in MoodDistribution)
                    {
                        <div class="mood-chart-item">
                            <div class="mood-bar" style="width: @(mood.Percentage * 3)px; background: @mood.Color"></div>
                            <div class="mood-info">
                                <span class="mood-emoji">@GetMoodEmoji(mood.Name)</span>
                                <span class="mood-name">@mood.Name</span>
                                <span class="mood-percentage">@mood.Percentage%</span>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Recent Entries -->
        <div class="analytics-card">
            <div class="card-header">
                <h4><i class="fas fa-history me-2"></i>Recent Entries</h4>
                <a href="/timeline" class="view-all">View All</a>
            </div>
        </div>

        <!-- Word Count Trends -->
        <div class="analytics-card">
            <div class="card-header">
                <h4><i class="fas fa-chart-line me-2"></i>Word Count Trends</h4>
                <select class="time-select" @bind="WordCountTimeRange">
                    <option value="7">Last 7 days</option>
                    <option value="30">Last 30 days</option>
                    <option value="90">Last 90 days</option>
                </select>
            </div>
            <div class="chart-container">
                <div class="word-count-chart">
                    <div class="chart-grid">
                        @for (int i = 0; i < 7; i++)
                        {
                            <div class="grid-line"></div>
                        }
                    </div>
                    <div class="chart-bars">
                        @foreach (var data in wordCountDatas)
                        {
                            var height = Math.Min(data.WordCount / 5, 100);
                            <div class="chart-bar" style="height: @(height)px">
                                <div class="bar-value">@data.WordCount</div>
                                <div class="bar-label">@data.Date.ToString("MMM d")</div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Most Used Tags -->
        <div class="analytics-card">
            <div class="card-header">
                <h4><i class="fas fa-tags me-2"></i>Most Used Tags</h4>
                <div class="tag-cloud">
                    @foreach (var tag in PopularTags)
                    {
                        var size = 14 + (tag.Count * 2);
                        <span class="cloud-tag" style="font-size: @(size)px; color: @GetTagColor(tag.Name)">
                            @tag.Name <span class="tag-count">@tag.Count</span>
                        </span>
                    }
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="analytics-card stats-card">
            <div class="card-header">
                <h4><i class="fas fa-chart-bar me-2"></i>Quick Stats</h4>
            </div>
            <div class="quick-stats-grid">
                <div class="quick-stat">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-times"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">@MissedDays</div>
                        <div class="stat-label">Missed Days</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="stat-icon">
                        <i class="fas fa-edit"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">@AvgWords</div>
                        <div class="stat-label">Avg. Words</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">@AvgTime</div>
                        <div class="stat-label">Avg. Time</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="stat-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">@MostCommonMood</div>
                        <div class="stat-label">Top Mood</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Journaling Streak -->
    <div class="streak-section">
        <h3><i class="fas fa-fire me-2"></i>Your Journaling Streak</h3>
        <div class="streak-calendar">
            @for (int i = 29; i >= 0; i--)
            {
                var date = DateTime.Today.AddDays(-i);
                var hasEntry = JournalService.GetAll().Any(e => e.EntryDate.Date == date.Date);

                <div class="streak-day @(hasEntry ? "active" : "inactive") @(date.Date == DateTime.Today ? "today" : "")">
                    <div class="day-label">@date.ToString("ddd")</div>
                    <div class="day-number">@date.Day</div>
                    <div class="day-indicator"></div>
                </div>
            }
        </div>
        <div class="streak-info">
            <div class="streak-message">
                @if (CurrentStreak >= 7)
                {
                    <span class="text-success">🔥 Amazing! You've journaled for @CurrentStreak consecutive days!</span>
                }
                else if (CurrentStreak >= 3)
                {
                    <span class="text-warning">📝 Keep going! You're on a @CurrentStreak-day streak!</span>
                }
                else if (CurrentStreak == 0)
                {
                    <span class="text-info">✏️ Start your journaling streak today!</span>
                }
            </div>
            <button class="btn btn-primary" @onclick="NavigateToCalendar">
                <i class="fas fa-calendar-alt me-2"></i>View Full Calendar
            </button>
        </div>
    </div>
</div>

@code {
    // Today's Entry
    private string TodayTitle = "";
    private string TodayContent = "";
    private string SelectedMood = "Happy";
    private string NewTag = "";
    private List<string> SelectedTags = new();

    // Stats
    private int CurrentStreak = 14;
    private int LongestStreak = 30;
    private int TotalEntries = 156;
    private int PositivePercentage = 78;
    private int MissedDays = 12;
    private int AvgWords = 245;
    private string AvgTime = "8:30 PM";
    private string MostCommonMood = "Happy";

    // Analytics
    private string MoodTimeRange = "30";
    private string WordCountTimeRange = "30";

    private readonly string[] QuickMoods = { "Happy", "Calm", "Excited", "Thoughtful", "Grateful", "Stressed" };

    private List<MoodData> MoodDistribution = new()
    {
        new MoodData { Name = "Happy", Percentage = 35, Color = "#2ecc71" },
        new MoodData { Name = "Calm", Percentage = 25, Color = "#3498db" },
        new MoodData { Name = "Thoughtful", Percentage = 20, Color = "#9b59b6" },
        new MoodData { Name = "Stressed", Percentage = 12, Color = "#e74c3c" },
        new MoodData { Name = "Excited", Percentage = 8, Color = "#f1c40f" }
    };

    private List<WordCountData> wordCountDatas = new()
    {
        new WordCountData { Date = DateTime.Today.AddDays(-6), WordCount = 120 },
        new WordCountData { Date = DateTime.Today.AddDays(-5), WordCount = 180 },
        new WordCountData { Date = DateTime.Today.AddDays(-4), WordCount = 95 },
        new WordCountData { Date = DateTime.Today.AddDays(-3), WordCount = 210 },
        new WordCountData { Date = DateTime.Today.AddDays(-2), WordCount = 150 },
        new WordCountData { Date = DateTime.Today.AddDays(-1), WordCount = 190 },
        new WordCountData { Date = DateTime.Today, WordCount = 165 }
    };

    private List<TagCount> PopularTags = new()
    {
        new TagCount { Name = "Work", Count = 45 },
        new TagCount { Name = "Health", Count = 32 },
        new TagCount { Name = "Personal Growth", Count = 28 },
        new TagCount { Name = "Family", Count = 24 },
        new TagCount { Name = "Fitness", Count = 18 },
        new TagCount { Name = "Travel", Count = 15 },
        new TagCount { Name = "Reading", Count = 12 },
        new TagCount { Name = "Music", Count = 10 }
    };

    private List<JournalEntry> RecentEntries = new();

    private void LoadRecentEntries()
    {
        RecentEntries = JournalService.GetAll()
            .OrderByDescending(e => e.EntryDate)
            .Take(5)
            .ToList();
    }

   

    private int CalculateCurrentStreak(List<JournalEntry> entries)
    {
        if (!entries.Any()) return 0;

        var streak = 0;
        var currentDate = DateTime.Today;

        while (true)
        {
            if (entries.Any(e => e.EntryDate.Date == currentDate.Date))
            {
                streak++;
                currentDate = currentDate.AddDays(-1);
            }
            else
            {
                break;
            }
        }

        return streak;
    }

    private int CalculateLongestStreak(List<JournalEntry> entries)
    {
        if (!entries.Any()) return 0;

        var sortedDates = entries.Select(e => e.EntryDate.Date).Distinct().OrderBy(d => d).ToList();
        var longestStreak = 0;
        var currentStreak = 1;

        for (int i = 1; i < sortedDates.Count; i++)
        {
            if ((sortedDates[i] - sortedDates[i - 1]).Days == 1)
            {
                currentStreak++;
                longestStreak = Math.Max(longestStreak, currentStreak);
            }
            else
            {
                currentStreak = 1;
            }
        }

        return Math.Max(longestStreak, currentStreak);
    }

    private bool IsPositiveMood(string? mood)
    {
        if (string.IsNullOrEmpty(mood)) return false;

        var positiveMoods = new[] { "Happy", "Excited", "Relaxed", "Grateful", "Confident" };
        return positiveMoods.Contains(mood);
    }

    private string GetMoodEmoji(string? mood)
    {
        return mood switch
        {
            "Happy" => "😊",
            "Excited" => "🎉",
            "Relaxed" => "😌",
            "Grateful" => "🙏",
            "Confident" => "💪",
            "Calm" => "🧘",
            "Thoughtful" => "🤔",
            "Curious" => "🔍",
            "Nostalgic" => "📸",
            "Bored" => "😒",
            "Sad" => "😢",
            "Angry" => "😠",
            "Stressed" => "😫",
            "Lonely" => "😔",
            "Anxious" => "😰",
            _ => "📝"
        };
    }

    private string GetTagColor(string tag)
    {
        var colors = new[]
        {
            "#3498db", "#2ecc71", "#9b59b6", "#f1c40f",
            "#e74c3c", "#1abc9c", "#34495e", "#e67e22"
        };

        var hash = tag.GetHashCode();
        var index = Math.Abs(hash % colors.Length);
        return colors[index];
    }

    private void SelectMood(string mood)
    {
        SelectedMood = mood;
    }

    private void AddTag()
    {
        if (!string.IsNullOrWhiteSpace(NewTag) && !SelectedTags.Contains(NewTag))
        {
            SelectedTags.Add(NewTag);
            NewTag = "";
        }
    }

    private void RemoveTag(string tag)
    {
        SelectedTags.Remove(tag);
    }

    private void HandleTagKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" || e.Key == ",")
        {
            AddTag();
        }
    }

    private void ViewEntry(Guid entryId)
    {
        NavigationManager.NavigateTo($"/entry/{entryId}");
    }

    private void NavigateToCalendar()
    {
        NavigationManager.NavigateTo("/calendar");
    }

    // Data classes
    private class MoodData
    {
        public string Name { get; set; } = "";
        public int Percentage { get; set; }
        public string Color { get; set; } = "";
    }

    private class WordCountData
    {
        public DateTime Date { get; set; }
        public int WordCount { get; set; }
    }

    private class TagCount
    {
        public string Name { get; set; } = "";
        public int Count { get; set; }
    }
}

<style>
    .dashboard-container {
        padding: 20px;
        background: #f8f9fa;
        min-height: 100vh;
    }

    /* Header Styles */
    .dashboard-header {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        color: black;
        position: relative;
        overflow: hidden;
    }

        .dashboard-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.3;
        }

    .welcome-title {
        margin: 0 0 10px 0;
        font-size: 2rem;
        font-weight: 700;
        display: flex;
        align-items: center;
    }

    .welcome-sub {
        display: block;
        font-size: 1rem;
        font-weight: 400;
        opacity: 0.9;
        margin-top: 5px;
    }

    .header-stats {
        display: flex;
        gap: 30px;
        margin-top: 20px;
        flex-wrap: wrap;
    }

    .header-stat {
        text-align: center;
    }

    .stat-number {
        font-size: 2.5rem;
        font-weight: 800;
        line-height: 1;
        margin-bottom: 5px;
    }

        .stat-number.streak {
            color: #f39c12;
        }

        .stat-number.total {
            color: #3498db;
        }

        .stat-number.positive {
            color: #2ecc71;
        }

        .stat-number.longest {
            color: #9b59b6;
        }

    .stat-label {
        font-size: 0.9rem;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* Today's Card */
    .today-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .today-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
    }

        .today-header h3 {
            margin: 0;
            font-size: 1.3rem;
            color: #2c3e50;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

    .date-label {
        font-size: 1rem;
        color: #7f8c8d;
        font-weight: normal;
    }

    .mood-indicators {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
    }

    .mood-label {
        color: #6c757d;
        font-weight: 500;
    }

    .mood-buttons {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    .mood-btn {
        padding: 8px 16px;
        border: 2px solid #e9ecef;
        border-radius: 20px;
        background: white;
        color: #6c757d;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.3s ease;
        font-size: 0.9rem;
    }

        .mood-btn:hover {
            border-color: #3498db;
            color: #3498db;
        }

        .mood-btn.active {
            background: #3498db;
            border-color: #3498db;
            color: white;
        }

    .mood-emoji {
        font-size: 1.2rem;
    }

    .mood-name {
        font-weight: 500;
    }

    /* Today's Editor */
    .today-editor {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .entry-title-input {
        padding: 15px;
        font-size: 1.2rem;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        transition: all 0.3s ease;
        outline: none;
    }

        .entry-title-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

    .entry-content-input {
        padding: 15px;
        font-size: 1rem;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        resize: vertical;
        min-height: 120px;
        transition: all 0.3s ease;
        outline: none;
        font-family: inherit;
    }

        .entry-content-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

    .entry-tags {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .tags-input {
        display: flex;
        gap: 10px;
    }

    .tag-input {
        flex: 1;
        padding: 10px 15px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        outline: none;
        transition: all 0.3s ease;
    }

        .tag-input:focus {
            border-color: #3498db;
        }

    .add-tag-btn {
        padding: 10px 20px;
        background: #3498db;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s ease;
    }

        .add-tag-btn:hover {
            background: #2980b9;
        }

    .selected-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }

    .selected-tag {
        padding: 6px 12px;
        background: #e9ecef;
        border-radius: 20px;
        font-size: 0.9rem;
        color: #6c757d;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .remove-tag {
        background: none;
        border: none;
        color: #95a5a6;
        cursor: pointer;
        padding: 2px;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .remove-tag:hover {
            background: #dee2e6;
            color: #e74c3c;
        }

    .entry-actions {
        display: flex;
        gap: 10px;
    }

    .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .btn-primary {
        background: #3498db;
        color: white;
    }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
        }

    .btn-outline {
        background: transparent;
        border: 2px solid #dee2e6;
        color: #6c757d;
    }

        .btn-outline:hover {
            border-color: #3498db;
            color: #3498db;
        }

    /* Analytics Grid */
    .analytics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 25px;
    }

    .analytics-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        transition: transform 0.3s ease;
    }

        .analytics-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

        .card-header h4 {
            margin: 0;
            font-size: 1.1rem;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }

    .time-select, .view-all {
        font-size: 0.9rem;
        color: #6c757d;
        text-decoration: none;
    }

        .view-all:hover {
            color: #3498db;
        }

    /* Mood Chart */
    .mood-chart {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .mood-chart-item {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .mood-bar {
        height: 8px;
        border-radius: 4px;
        min-width: 10px;
    }

    .mood-info {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
    }

    .mood-percentage {
        margin-left: auto;
        font-weight: 600;
        color: #2c3e50;
        min-width: 40px;
        text-align: right;
    }

    /* Recent Entries */
    .recent-entries {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .recent-entry {
        padding: 12px;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: grid;
        grid-template-columns: auto auto 1fr auto;
        gap: 12px;
        align-items: center;
    }

        .recent-entry:hover {
            background: #f8f9fa;
            border-color: #3498db;
            transform: translateX(4px);
        }

    .entry-date {
        font-size: 0.9rem;
        color: #7f8c8d;
        font-weight: 500;
        min-width: 45px;
    }

    .entry-mood {
        font-size: 1.2rem;
    }

    .entry-content {
        overflow: hidden;
    }

    .entry-title {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .entry-preview {
        font-size: 0.9rem;
        color: #6c757d;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .entry-tags {
        display: flex;
        gap: 4px;
    }

    .tag {
        font-size: 0.7rem;
        padding: 2px 6px;
        background: #e9ecef;
        border-radius: 4px;
        color: #6c757d;
    }

    /* Word Count Chart */
    .word-count-chart {
        height: 200px;
        position: relative;
        display: flex;
        align-items: flex-end;
        gap: 10px;
        padding: 20px 0;
    }

    .chart-grid {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .grid-line {
        border-bottom: 1px dashed #e9ecef;
    }

    .chart-bars {
        display: flex;
        gap: 15px;
        align-items: flex-end;
        flex: 1;
        justify-content: space-between;
    }

    .chart-bar {
        background: linear-gradient(180deg, #3498db, #2ecc71);
        border-radius: 4px 4px 0 0;
        position: relative;
        flex: 1;
        min-width: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-end;
        padding-bottom: 5px;
    }

    .bar-value {
        color: white;
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 5px;
    }

    .bar-label {
        color: #6c757d;
        font-size: 0.8rem;
        writing-mode: vertical-rl;
        transform: rotate(180deg);
    }

    /* Tag Cloud */
    .tag-cloud {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
    }

    .cloud-tag {
        padding: 4px 8px;
        background: #f8f9fa;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

        .cloud-tag:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

    .tag-count {
        font-size: 0.8em;
        opacity: 0.7;
        margin-left: 2px;
    }

    /* Quick Stats */
    .stats-card .card-header {
        margin-bottom: 0;
    }

    .quick-stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 15px;
    }

    .quick-stat {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .stat-icon {
        width: 40px;
        height: 40px;
        background: #3498db;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.2rem;
    }

    .stat-value {
        font-size: 1.2rem;
        font-weight: 700;
        color: #2c3e50;
    }

    .stat-label {
        font-size: 0.8rem;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Streak Section */
    .streak-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

        .streak-section h3 {
            margin: 0 0 20px 0;
            font-size: 1.3rem;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }

    .streak-calendar {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        overflow-x: auto;
        padding: 10px 0;
    }

    .streak-day {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        min-width: 50px;
        padding: 10px;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

        .streak-day.active {
            background: #2ecc71;
            color: white;
        }

        .streak-day.inactive {
            background: #f8f9fa;
            color: #95a5a6;
        }

        .streak-day.today {
            border: 2px solid #3498db;
        }

    .day-label {
        font-size: 0.8rem;
        font-weight: 600;
    }

    .day-number {
        font-size: 1.1rem;
        font-weight: 700;
    }

    .day-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }

    .streak-day.active .day-indicator {
        background: rgba(255,255,255,0.5);
    }

    .streak-day.inactive .day-indicator {
        background: #dee2e6;
    }

    .streak-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
    }

    .streak-message {
        font-size: 1.1rem;
        font-weight: 500;
    }

    .text-success {
        color: #2ecc71;
    }

    .text-warning {
        color: #f39c12;
    }

    .text-info {
        color: #3498db;
    }

    /* Responsive Design */
    @@media (max-width: 768px) {
        .dashboard-header {
            padding: 20px;
        }

        .welcome-title {
            font-size: 1.5rem;
        }

        .header-stats {
            gap: 20px;
            justify-content: space-between;
        }

        .header-stat {
            flex: 1;
            min-width: calc(50% - 10px);
        }

        .stat-number {
            font-size: 2rem;
        }

        .today-header {
            flex-direction: column;
        }

        .mood-indicators {
            width: 100%;
        }

        .analytics-grid {
            grid-template-columns: 1fr;
        }

        .streak-calendar {
            flex-wrap: wrap;
            justify-content: center;
        }

        .streak-info {
            flex-direction: column;
            align-items: stretch;
        }
    }

    @@media (min-width: 769px) and (max-width: 1024px) {
        .analytics-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>

@inject NavigationManager NavigationManager